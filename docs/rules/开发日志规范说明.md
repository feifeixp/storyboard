# 开发日志规范说明

**规则ID**: R007  
**规则类型**: mandatory（强制规则）  
**创建日期**: 2024-12-26  
**状态**: ✅ 已启用

---

## 📋 规则概述

**规则目标**：建立标准化的开发日志记录机制，用于项目回顾、避免重复工作和保持开发一致性。

**适用范围**：所有重大功能开发、架构调整、问题修复、代码重构、性能优化等操作。

---

## 🎯 触发条件

以下情况**必须**记录开发日志：

| 触发事件 | 说明 | 示例 |
|---------|------|------|
| ✨ 重大功能开发 | 新增核心功能模块 | 实现场景重新提取功能 |
| 🏗️ 架构调整 | 修改系统架构或设计模式 | 重构数据流架构 |
| 🐛 问题修复 | 修复影响功能的bug | 修复场景数量递减问题 |
| ♻️ 代码重构 | 大规模代码重构 | 重构角色管理模块 |
| ⚡ 性能优化 | 显著的性能改进 | 优化分批分析性能 |

**不需要记录的情况**：
- ❌ 微小的代码调整（如修改变量名）
- ❌ 注释更新
- ❌ 代码格式化
- ❌ 依赖版本更新（除非涉及重大变更）

---

## 📝 记录要求

### 必填字段

| 字段 | 要求 | 示例 |
|-----|------|------|
| **时间戳** | YYYY-MM-DD HH:MM | 2024-12-26 14:30 |
| **变更类型** | 使用标准图标和标签 | ✨ 新功能 |
| **修改内容** | 50-200字简洁总结 | 实现场景重新提取功能，支持智能去重 |
| **影响范围** | 列出涉及的文件/模块 | services/sceneExtraction.ts（新增） |
| **修改原因** | 说明为什么要做这个修改 | 初次分析可能遗漏场景 |
| **预期效果** | 说明修改后的预期效果 | 用户可以随时重新提取场景 |

### 可选字段

| 字段 | 说明 | 示例 |
|-----|------|------|
| **相关文档** | 关联的技术文档 | 场景重新提取功能-实现文档.md |
| **相关Issue** | 关联的问题编号 | #123 |
| **影响版本** | 影响的版本号 | v1.2.0 |

---

## 📐 日志格式

### 标准模板

```markdown
## [YYYY-MM-DD HH:MM] 图标 变更类型

**修改内容**：简洁总结修改内容（50-200字）

**影响范围**：
- 文件/模块：列出涉及的文件和模块

**修改原因**：说明为什么要做这个修改

**预期效果**：说明修改后的预期效果

**相关文档**：列出相关的技术文档（可选）

---
```

### 变更类型定义

| 图标 | 类型 | 英文标识 | 使用场景 |
|-----|------|---------|---------|
| ✨ | 新功能 | feature | 新增功能模块 |
| 🐛 | 问题修复 | fix | 修复bug |
| ♻️ | 代码重构 | refactor | 代码重构 |
| ⚡ | 性能优化 | perf | 性能改进 |
| 🏗️ | 架构调整 | arch | 架构变更 |
| 📝 | 文档更新 | docs | 文档修改 |

---

## 📊 示例

### 示例1: 新功能开发

```markdown
## [2024-12-26 14:30] ✨ 新功能

**修改内容**：实现场景重新提取功能，支持从剧本中智能提取新场景，自动去重（精确匹配+相似度检测80%阈值）

**影响范围**：
- 文件/模块：services/sceneExtraction.ts（新增）、components/ProjectDashboard.tsx（修改）

**修改原因**：初次分析可能遗漏场景，需要提供重新提取功能补充场景库

**预期效果**：用户可以随时从剧本中重新提取场景，自动过滤重复场景，提升场景库完整性

**相关文档**：场景重新提取功能-实现文档.md

---
```

### 示例2: 问题修复

```markdown
## [2024-12-26 10:15] 🐛 问题修复

**修改内容**：修复场景数量递减问题，增强预扫描取样（3000字→5000字），新增场景验证机制

**影响范围**：
- 文件/模块：services/projectAnalysis.ts（修改）

**修改原因**：重新分析时场景数量从10个减少到9个，预扫描发现的场景在分批分析中丢失

**预期效果**：场景数量稳定，预扫描发现的场景100%被保留

**相关文档**：项目分析功能修复总结.md

---
```

### 示例3: 架构调整

```markdown
## [2024-12-26 09:00] 🏗️ 架构调整

**修改内容**：重构数据流架构，将状态管理从组件中抽离到独立的store，使用Context API实现全局状态共享

**影响范围**：
- 文件/模块：store/projectStore.ts（新增）、components/（多个组件修改）

**修改原因**：组件间状态传递复杂，props drilling严重，需要统一的状态管理方案

**预期效果**：简化组件间通信，提高代码可维护性，便于后续功能扩展

---
```

---

## ✅ 最佳实践

### 1. 及时记录

```
✅ 推荐：完成修改后立即记录
❌ 避免：等到一天结束时批量记录（容易遗忘细节）
```

### 2. 简洁明确

```
✅ 推荐：实现场景重新提取功能，支持智能去重
❌ 避免：今天写了一些代码，改了几个文件
```

### 3. 关联文档

```
✅ 推荐：相关文档：场景重新提取功能-实现文档.md
❌ 避免：没有关联文档引用
```

### 4. 避免代码

```
✅ 推荐：新增场景验证函数ensurePreScannedScenesIncluded
❌ 避免：粘贴大段代码实现
```

### 5. 分类清晰

```
✅ 推荐：使用标准分类图标（✨🐛♻️⚡🏗️📝）
❌ 避免：自定义分类或不使用图标
```

---

## 🎯 预期效果

### 1. 清晰的开发历史轨迹

通过时间线了解项目演进过程：
```
2024-12-26 17:00 → 新增开发日志规范
2024-12-26 16:00 → 实现场景重新提取功能
2024-12-26 14:00 → 修复场景数量递减问题
2024-12-26 12:00 → 统一使用新版API
```

### 2. 防止重复开发

查看日志避免重复实现相同功能：
```
搜索"场景提取" → 发现已在2024-12-26实现 → 避免重复开发
```

### 3. 保持决策一致性

确保前后开发决策的连贯性：
```
查看历史日志 → 了解之前的设计决策 → 保持一致的架构风格
```

### 4. 便于团队协作

团队成员快速了解项目变更历史：
```
新成员加入 → 阅读开发日志 → 快速了解项目演进
```

### 5. 问题追溯

出现问题时快速定位相关修改：
```
发现bug → 搜索相关功能的修改日志 → 定位问题引入时间
```

---

## 🔍 日志检索技巧

### 按时间检索

```
搜索：[2024-12-26
结果：当天的所有修改记录
```

### 按类型检索

```
搜索：✨ 新功能
结果：所有新功能开发记录
```

### 按文件检索

```
搜索：projectAnalysis.ts
结果：涉及该文件的所有修改
```

### 按关键词检索

```
搜索：场景提取
结果：所有与场景提取相关的修改
```

---

## 📂 文件位置

**日志文件**：`DEVELOPMENT_LOG.md`（项目根目录）

**规则配置**：`.augment/rules/rules.md`（规则R007）

---

## ⚠️ 注意事项

1. **强制执行**：本规则为mandatory类型，必须遵守
2. **不包含代码**：日志中不应包含具体代码实现细节
3. **保持简洁**：摘要控制在50-200字
4. **及时更新**：完成修改后立即记录
5. **格式统一**：使用标准模板和分类

---

**规则创建时间**：2024-12-26  
**最后更新时间**：2024-12-26  
**维护人**：AI Assistant

